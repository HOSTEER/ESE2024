
#include <stdint.h>

/*static uint64_t frac16[16] = {5000000000000000, 2500000000000000, 1250000000000000, 625000000000000,
							  312500000000000, 156250000000000, 78125000000000, 39062500000000,
							  19531250000000, 9765625000000, 4882812500000, 2441406250000,
							  1220703125000, 610351562500, 305175781250, 152587890625};
*/

static uint64_t frac16[16] = {152587890625, 305175781250, 610351562500, 1220703125000,
							  2441406250000, 4882812500000, 9765625000000, 19531250000000,
							  39062500000000, 78125000000000, 156250000000000, 312500000000000,
							  625000000000000, 1250000000000000, 2500000000000000, 5000000000000000};

uint64_t conv_frac16_dec(int16_t x, uint64_t scale)
{
	uint64_t out = 0;
	for(int i=0;i<16;i++)
	{
		out += ((x>>i)&1)*frac16[i];
	}
	return out/scale;
}

int32_t fixed_div_16(int32_t x, int32_t y)
{
	return (((int64_t)x) * (1 << 16)) / y;
}

int32_t fixed_mul_16(int32_t x, int32_t y)
{
    return ((int64_t)x * (int64_t)y) / (1 << 16);
}
